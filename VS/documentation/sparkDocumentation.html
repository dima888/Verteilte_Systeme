<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>Spark Framework - Documentation</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <meta name="description" content="Spark Framework - Create web applications in Java rapidly. Spark is a micro web framework that lets you focus on writing your code, not boilerplate code.">
        <script src="sparkDocumentation-Dateien/analytics.js" async="" type="text/javascript"></script><script src="sparkDocumentation-Dateien/gtm.js" async=""></script><script>for(var a="nav section footer".split(" "),b=0;b<a.length;b++){document.createElement(a[b])}</script>
        <link rel="stylesheet" media="screen" href="sparkDocumentation-Dateien/main.css">
        <link rel="shortcut icon" type="image/png" href="http://sparkjava.com/assets/images/favicon.png">
    <script src="sparkDocumentation-Dateien/jquery-1.js"></script><script src="sparkDocumentation-Dateien/js.js"></script></head>

    <body>
        <!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-W4XBCK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W4XBCK');</script>
<!-- End Google Tag Manager -->
        <!-- Fork me on GitHub -->
<a id="fork-me" href="https://github.com/perwendel/spark" target="_blank">
    <img style="position:fixed;top:0;right:0;border:0;z-index:99999" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJUAAACVCAMAAABmfEh9AAAAllBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEhwAAAAFBgkAAAARFR8fIiwRFB4YHCUQEx0RFB4SFiERFB8QEx3s7e4eIStPUlpKTFUvMjwOEhs8P0hfYmlXWmE5PUUZHSfd3uAnKjTAwcRnanB2eH5CRU6TlZqxs7bP0NKFh4yUlpqipKiUlpujpKiipKdzB4/DAAAAFXRSTlMAAwgBDREiKBYbL5wdQBjb3ZzclY3cWcIvAAAGZ0lEQVR42u2c3W7bMAyF02bL2q5bu7WLqDhW7Si24p902/u/3EglljxXQX1jixclsIv0QvhAHvAQZLJFF8vl1dX19afn/Ub9ej+2L5ufd6v725vPn66vr66ulsvFBOGoPj/LLJHvY8kkf/j2ZTUtlqe6ed6+JCOytX/ZPCLW/aRYnur2aZeo3QisjXogrO+TYjmq1ROqZgQWlvpxaiyisljf71dP+yQfJflk8mwtfbK+/NhnmxGSx1L/nBhraZP1ySbr7sc2O4xrEIMiTpqsu6+7zWGU5PNpi0hUfaxRkl9jqR9nxZLjJJ8d5s3W/mWU5Dfq56xY4z1x3iJuxnrinFg/xnrizJLfJZeLuMboJK9mbxDyIpPjkpvD48ySz4NQLpwnzopFY2CYqfzti7ibXfLZIQQlSoBjT1sRJL8bUgmCaiyWHwOjemKXqVIWYDwWljqmJ56h6jSVfyR+YOGJlCpbvipNhXBUbgycVfKqR3UuX0JUGNE8kcZA2VEphMLyZdIYabGieeJX74mYKyNEmiYaQCuLFdMTcy8sIUSuwWT6lYpI4SUfwRM9Vk1lbLQYYO3m90TVyxa1hgqqVEmHFdkTCaLRWQVa5rrAdMla+WzNPwYeXLaUBihyVBfUUhaAVh1zDNx1yZJllpLk20IWzqjjeaJXfK5J8ghVuQYRzxNdtpoOKt0674kjeVqNdFjqBAUatLJUMT3x0GtbCFXAqymVK2GkMZA80WH9gaqFLbVSGwxWI1ZbRhSFEAGsaKsRy7GFVlgsZT8yWI1YqkKtiUrpo+sPzhPjrEYsFv4jKGiMw/JjYCxPpCCotoDSYnFYjVgqRV3eQNNhRfdEwtoSVK51A+2wiBsVbww0BAWZBC08VuTVCAkroXQl8DdFLD6eaMCmK9+bTLzxxIdonqgIqixpGJTRPdGNgYIknwG0GZT4kcW5gLBQ8g0UugRzVhaLMVCIFF5lAXq7tsHhXGCxdCNlUboJItYYSEXMlOvxJTRK9AabqOeCg+ywslbYSExyIovuiQRxnpuPAICDDY/VSId1hCKrQHVtnsVqZJ1AIdMSTJqc2zyL1YiBhBr9voLOfTisRkqoMg2mAizksEHk8TwRxU5QhdGwdZKPey6wA7PZViQurOW6i/irESEMQckGc+UjqidaAtEiVAGtEJ7KST6KJ67dDuLYdfrWyp7BamTdnqFkDRj2vMJgNbI2lDFKmW6zGtqe5OOcC7z7EFSxRbhae6r1PoviiV71BhpJh6iyPCk++oXMUmm0HwyB8bvlcC74dXJqZLLZSkD/3yDirUYkNGmaN3maJsJkwmJFXo2c+kPdApi0hDaV557K4FyATFAilM6roupafTRPlJ3eZXGCMgAVZuuo4nnifuM9UQmCkgWQY1fQSPpjrNWIz5Y6QVVlhVBaifieaLFKldZ01SeoPBVSRfXEXYclEqgt1On0oxHrwmrEUU05BjptQZNQprStZf/uIwee6F6bYwwsa0nly7UmKHHxWyOeap4x0ICmFg9WWvSX4DcpHdWUReydC2StTpe7WuZdkw+sRgYPTrcacZonKF2i2nOkCntij2omTxQERWovpNsmvfl1weC56TzR33wwS9S5ZFoqGrjK3hioHk5Yg9em9ESnLZUa6lwlNFIc7br5/3PB7c3gsUk90WurAWnNOq3cDrzvibfDxyYdAx1WDcZ0UKStwbngPvDcHOeCGk5QUGSOynviKvDaHGOgqBHKb2wGP6i5Cz43xwldpd3GJnAuWIRj+hO6MABJKvu58p4YemtiT/RYr0b3Tyte8oGX5pK8qAGg9WL3sV1cjum/NVKabjk5iMvPTbwa6e//IlBdWo14qAhU75wLkCkC1bs/qIlFFfZEBlSBMZADVcgTGVCFJM+A6o3kk5wDVWg1woAq4IkcqEKeyIAq4Ik7BlSBMZADVWgMZEAV8EQOVCFPZEAV8EQOVAFP5EAV8kQGVIHVCAeqt5LfSAZUAU/kQBX6JiUDqtBqhAFVwBM5UIU8kQHVW8krDlShcwEDqoAncqAaYqEncqAaYpEnMqD6D2v15QnHQA5Ufaz71eqJxsAFg/BY35HriXbIHMJhEdftM+6QWUSHRVw3+L+VLXhEh4VcGM8LJnHGQjCKBZcgLOKysWATiEXBjAqxiMvGglEsMfhRWS4bC3bBk+ojPuIjPiIc/wAQkAE6ZqHsywAAAABJRU5ErkJggg==" alt="Fork me on GitHub">
</a>
<!-- End Fork me on GitHub -->
        <div id="some-buttons">
            <a id="some-twitter" href="https://twitter.com/sparkjava" target="_blank">
    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEiIHg9IjAiIHk9IjAiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSI0MCAtNjAgMjAwIDIwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA0MCAtNTkuOCAyMDAgMjAwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBmaWxsPSIjMkFBOUUwIiBkPSJNMTQwLTUwYzUwIDAgOTAgNDAgOTAgOTBzLTQwIDkwLTkwIDkwYy01MCAwLTkwLTQwLTkwLTkwUzkwLTUwIDE0MC01ME0xNDAtNjBDODUtNjAgNDAtMTUgNDAgNDBzNDUgMTAwIDEwMCAxMDBjNTUgMCAxMDAtNDUgMTAwLTEwMFMxOTUtNjAgMTQwLTYwTDE0MC02MHpNMTk5IDljLTQgMi05IDMtMTQgNCA1LTMgOS04IDExLTEzIC01IDMtMTAgNS0xNSA2IC00LTUtMTEtOC0xOC04IC0xMyAwLTI0IDExLTI0IDI0IDAgMiAwIDQgMSA2IC0yMC0xLTM4LTExLTUwLTI1IC0yIDQtMyA4LTMgMTIgMCA4IDQgMTYgMTEgMjAgLTQgMC04LTEtMTEtMyAwIDAgMCAwIDAgMCAwIDEyIDggMjIgMTkgMjQgLTIgMS00IDEtNiAxIC0yIDAtMyAwLTUgMCAzIDEwIDEyIDE3IDIzIDE3IC04IDctMTkgMTAtMzAgMTAgLTIgMC00IDAtNiAwIDExIDcgMjQgMTEgMzcgMTEgNDUgMCA2OS0zNyA2OS02OSAwLTEgMC0yIDAtM0MxOTIgMTggMTk2IDE0IDE5OSA5TDE5OSA5eiIvPjwvc3ZnPg==" title="Follow Spark on Twitter" alt="Follow Spark on Twitter">
</a>
            <a id="some-gplus" href="https://plus.google.com/+Sparkjavaplus" target="_blank">
    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEiIHg9IjAiIHk9IjAiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSItOSAtOSAyMDAgMjAwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IC05LjUgLTkuMiAyMDAgMjAwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBmaWxsPSIjREM0QTM4IiBkPSJNOTEtOWMtNTUgMC0xMDAgNDUtMTAwIDEwMCAwIDU1IDQ1IDEwMCAxMDAgMTAwczEwMC00NSAxMDAtMTAwQzE5MSAzNiAxNDYtOSA5MS05TDkxLTl6TTkxIDFjNTAgMCA5MCA0MCA5MCA5MCAwIDUwLTQwIDkwLTkwIDkwIC01MCAwLTkwLTQwLTkwLTkwQzEgNDEgNDEgMSA5MSAxTTEwNCAxMDVsLTUtNGMtMi0xLTQtMy00LTYgMC0zIDItNSA0LTcgNi01IDEzLTEwIDEzLTIxIDAtMTEtNy0xNy0xMS0yMGg5bDEwLTZIOTBjLTggMC0yMCAyLTI4IDkgLTYgNi05IDEzLTkgMjAgMCAxMiA5IDIzIDI1IDIzIDIgMCAzIDAgNSAwIC0xIDItMSAzLTEgNiAwIDUgMiA4IDUgMTAgLTcgMS0xOSAxLTI4IDcgLTkgNS0xMSAxMy0xMSAxOCAwIDExIDEwIDIxIDMyIDIxIDI2IDAgMzktMTQgMzktMjhDMTE2IDExNiAxMTAgMTEwIDEwNCAxMDV6TTg0IDg4Yy0xMyAwLTE5LTE3LTE5LTI3IDAtNCAxLTggMy0xMSAyLTMgNy01IDEwLTVDOTIgNDUgOTggNjIgOTggNzNjMCAzIDAgOC00IDExQzkyIDg2IDg4IDg4IDg0IDg4ek04NCAxNDhjLTE2IDAtMjYtOC0yNi0xOCAwLTExIDEwLTE0IDEzLTE1IDYtMiAxNC0yIDE2LTIgMiAwIDIgMCAzIDAgMTEgOCAxNiAxMiAxNiAyMEMxMDYgMTQxIDk5IDE0OCA4NCAxNDh6Ii8+PHBvbHlnb24gZmlsbD0iI0RDNEEzOCIgcG9pbnRzPSIxNDEgODggMTQxIDczIDEzNCA3MyAxMzQgODggMTE5IDg4IDExOSA5NSAxMzQgOTUgMTM0IDExMCAxNDEgMTEwIDE0MSA5NSAxNTYgOTUgMTU2IDg4ICIvPjwvc3ZnPg==" title="Follow Spark on Google Plus" alt="Follow Spark on Google Plus">
</a>
            <a id="some-facebook" href="https://www.facebook.com/sparkjava" target="_blank">
    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMCIgeT0iMCIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIHZpZXdCb3g9IjQwIC01OS44IDIwMCAyMDAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgNDAgLTU5LjggMjAwIDIwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZmlsbD0iIzNENUE5QSIgZD0iTTE0MC00OS44YzQ5LjYgMCA5MCA0MC40IDkwIDkwcy00MC40IDkwLTkwIDkwYy00OS42IDAtOTAtNDAuNC05MC05MFM5MC40LTQ5LjggMTQwLTQ5LjhNMTQwLTU5LjhDODQuOC01OS44IDQwLTE1IDQwIDQwLjNzNDQuOCAxMDAgMTAwIDEwMGM1NS4yIDAgMTAwLTQ0LjggMTAwLTEwMFMxOTUuMy01OS44IDE0MC01OS44TDE0MC01OS44eiIvPjxwYXRoIGZpbGw9IiMzQzVBOTkiIHN0cm9rZT0iIzQ4NUM5MCIgZD0iTTE0Mi44LTI0LjdMMTQzLTUuNWMtNC4yIDkuOC0xMi42IDI0LjgtMTguNiAzMC41bC0wLjgtMSAtNDEuNS0wLjFjLTIuMS0wLjEtNC40IDIuNS00LjMgNC4zbDQgNTcuM2MwLjEgMS45IDIgNC4yIDMuOSA0LjJoMzdjMS40IDAgMy40LTEuNSAzLjUtMy40bDAuMi01YzEuMiAxLjggNC40IDQuNSA3LjMgNC41aDQ5LjljNi4zIDAgMTUuOS03LjIgMTIuNy0xOS4zIDMuNS0zLjEgNS43LTguMyAzLjUtMTQuOSAzLjctMy4zIDYuNS05LjUgMy4zLTE1IDEwLTkgMy41LTIxLjYtNC4yLTIxLjZoLTMzLjZjMS4yLTYgMy4yLTEyIDMuMS0xOS45IC0wLjEtNi45LTQuMy0xNi45LTcuNC0yMi4yQzE1OS45LTI5LjUgMTQ4LjItMzMuNyAxNDIuOC0yNC43TDE0Mi44LTI0Ljd6Ii8+PHBhdGggZmlsbD0iIzZFN0ZCMyIgZD0iTTgyLjkgMjkuNGgzNC43bDAuMSA1NS40SDg2LjlMODIuOSAyOS40eiIvPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik0xNTkuNyAyMC4yYzEuNi03IDIuNy0xNC42IDMuNS0yMi4xIDAuMi0xLjggMC4yLTMuNC0wLjEtNC45IC0xLTYtMy4zLTExLjMtNS42LTE2LjcgLTIuMS0xLjgtNi40LTIuNS05LjUgMC4ydjE4LjhjLTUuMyAxMS4yLTExLjMgMjItMTguNyAzMS45bC03IDUuMnY0My42aDQuOGMwIDAgNi40IDQuMiA2LjggNCAwLjYgMC4zIDQ5LjkgMC4xIDQ5LjkgMC4xIDIuNiAwLjEgMTIuMy03LjYgNi4yLTEzLjQgLTAuOC0wLjUtMC43LTIuMSAwLjEtMi43IDMuOC0wLjcgOC41LTguNSAzLjYtMTIuNiAtMC44LTEtMC4yLTIuNSAwLjctMi42IDIuOC0xLjUgNy44LTYuNSAzLjMtMTIuNSAtMC45LTAuNS0wLjktMS44LTAuMS0yLjUgNC4zLTAuNiA5LjgtMTEuMiAwLjctMTMuOEwxNTkuNyAyMC4yeiIvPjwvc3ZnPg==" title="Like Spark on Facebook" alt="Like us on facebook">
</a>
        </div>
        <nav>
            <ul>
                <li id="logo"><a href="http://sparkjava.com/"><img src="sparkDocumentation-Dateien/logo.svg" alt="Spark framework logo"></a></li>
                <li id="news-li"><a href="http://sparkjava.com/news.html">News</a></li>
                <li id="contact-li"><a href="http://sparkjava.com/contact.html">Contact</a></li>
                <li id="tutorial-li"><a href="https://sparktutorials.github.io/" target="_blank">Tutorials</a></li>
                <li class="active" id="documentation-li"><a href="http://sparkjava.com/documentation.html">Documentation</a></li>
                <li id="download-li"><a href="http://sparkjava.com/download.html">Download</a></li>
            </ul>
        </nav>
        <div class="padding-hack"></div>
        

<section id="docs">

    <ul class="side-nav" id="docs-nav">
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#stopping-the-server">Stopping the Server</a></li>
        <li><a href="#routes">Routes</a></li>
        <li><a href="#request">Request</a></li>
        <li><a href="#response">Response</a></li>
        <li><a href="#query-maps">Query Maps</a></li>
        <li><a href="#cookies">Cookies</a></li>
        <li><a href="#sessions">Sessions</a></li>
        <li><a href="#halting">Halting</a></li>
        <li><a href="#filters">Filters</a></li>
        <li><a href="#redirects">Redirects</a></li>
        <li><a href="#exception-mapping">Exception Mapping</a></li>
        <li><a href="#static-files">Static Files</a></li>
        <li><a href="#response-transformer">ResponseTransformer</a></li>
        <li><a href="#views-templates">Views and Templates</a>
            <ul><li><a href="#freemarker">- Freemarker</a></li>
                <li><a href="#mustache">- Mustache</a></li>
                <li><a href="#velocity">- Velocity</a></li>
                <li><a href="#thymeleaf">- Thymeleaf</a></li>
                <li><a href="#jade">- Jade</a></li>
                <li><a href="#jetbrick">- Jetbrick</a></li>
                <li><a href="#handlebars">- Handlebars</a></li>
                <li><a href="#pebble">- Pebble</a></li>
                <li><a href="#water">- Water</a></li>
            </ul>
        </li>
        <li><a href="#embedded-webserver">Embedded Webserver</a>
            <ul><li><a href="#port">- Port</a></li>
                <li><a href="#secure">- Secure</a></li>
                <li><a href="#threadpool">- ThreadPool</a></li>
                <li><a href="#awaitinit">- Waiting for Initialization</a></li>
                <li><a href="#websockets">- WebSockets</a>
            </li></ul>
        </li>
        <li><a href="#other-webserver">Other Webserver</a></li>
        <li><a href="#gzip">GZIP</a></li>
        <li><a href="#javadoc">Javadoc</a></li>
        <li><a href="#examples">Examples/Tutorials</a></li>
    </ul>

    
<h1 id="getting-started" class="anchor">Getting started</h1>
<p>Create a new maven project and add the dependency to your <a href="http://maven.apache.org/pom.html" target="_blank">POM.xml</a>:</p>


<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<a class="maven-help" href="https://sparktutorials.github.io/2015/04/02/setting-up-a-spark-project-with-maven.html" target="_blank">
    Not familiar with Maven? Click here for more detailed instructions.
</a>

<p>Start coding:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token keyword">import</span> <span class="token keyword">static</span> spark<span class="token punctuation">.</span>Spark<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main<span class="token punctuation">(</span></span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>

<p>Run and view:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup">http://localhost:4567/hello</code></pre></div>

<p class="code-comment">
    That was easy, right? Spark is the simplest Java web framework to set up,
    while still providing enough functionality for many types of projects.
</p>
    
<h1 id="stopping-the-server" class="anchor">Stopping the Server</h1>
<p>By calling the stop() method the server is stopped and all routes are cleared.<br><br></p>
    
<h1 id="routes" class="anchor">Routes</h1>
<p>The main building block of a Spark application is a set of routes. A route is made up of three simple pieces:</p>
<ul class="code-list">
    <li>A <strong>verb</strong> (get, post, put, delete, head, trace, connect, options)</li>
    <li>A <strong>path</strong> (/hello, /users/:name)</li>
    <li>A <strong>callback</strong> (request, response) -&gt; { }</li>
</ul>
<p>Routes are matched in the order they are defined. The first route that matches the request is invoked.</p>


<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">// .. Show something ..
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">post<span class="token punctuation">(</span></span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">// .. Create something ..
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">put<span class="token punctuation">(</span></span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">// .. Update something ..
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">delete<span class="token punctuation">(</span></span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">// .. annihilate something ..
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">options<span class="token punctuation">(</span></span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">// .. appease something ..
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>Route patterns can include named parameters, accessible via the params method on the request object:</p>


<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token comment" spellcheck="true">// matches "GET /hello/foo" and "GET /hello/bar"
</span><span class="token comment" spellcheck="true">// request.params(":name") is 'foo' or 'bar'
</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/hello/:name"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"Hello: "</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">params<span class="token punctuation">(</span></span><span class="token string">":name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>Route patterns can also include splat (or wildcard) parameters. These
 parameters can be accessed by using the splat method on the request 
object:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token comment" spellcheck="true">// matches "GET /say/hello/to/world"
</span><span class="token comment" spellcheck="true">// request.splat()[0] is 'hello' and request.splat()[1] 'world'
</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/say/*/to/*"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"Number of splat parameters: "</span> <span class="token operator">+</span> request<span class="token punctuation">.</span><span class="token function">splat<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
    
<h1 id="request" class="anchor">Request</h1>
<p>In the handle method request information and functionality is provided by the request parameter:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">request<span class="token punctuation">.</span><span class="token function">attributes<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">// the attributes list
</span>request<span class="token punctuation">.</span><span class="token function">attribute<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">// value of foo attribute
</span>request<span class="token punctuation">.</span><span class="token function">attribute<span class="token punctuation">(</span></span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"V"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// sets value of attribute A to V
</span>request<span class="token punctuation">.</span><span class="token function">body<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// request body sent by the client
</span>request<span class="token punctuation">.</span><span class="token function">bodyAsBytes<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// request body as bytes
</span>request<span class="token punctuation">.</span><span class="token function">contentLength<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// length of request body
</span>request<span class="token punctuation">.</span><span class="token function">contentType<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// content type of request.body
</span>request<span class="token punctuation">.</span><span class="token function">contextPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// the context path, e.g. "/hello"
</span>request<span class="token punctuation">.</span><span class="token function">cookies<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// request cookies sent by the client
</span>request<span class="token punctuation">.</span><span class="token function">headers<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// the HTTP header list
</span>request<span class="token punctuation">.</span><span class="token function">headers<span class="token punctuation">(</span></span><span class="token string">"BAR"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">// value of BAR header
</span>request<span class="token punctuation">.</span><span class="token function">host<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// the host, e.g. "example.com"
</span>request<span class="token punctuation">.</span><span class="token function">ip<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">// client IP address
</span>request<span class="token punctuation">.</span><span class="token function">params<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// value of foo path parameter
</span>request<span class="token punctuation">.</span><span class="token function">params<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment" spellcheck="true">// map with all parameters
</span>request<span class="token punctuation">.</span><span class="token function">pathInfo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">// the path info
</span>request<span class="token punctuation">.</span><span class="token function">port<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// the server port
</span>request<span class="token punctuation">.</span><span class="token function">protocol<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">// the protocol, e.g. HTTP/1.1
</span>request<span class="token punctuation">.</span><span class="token function">queryMap<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">// the query map
</span>request<span class="token punctuation">.</span><span class="token function">queryMap<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// query map for a certain parameter
</span>request<span class="token punctuation">.</span><span class="token function">queryParams<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// the query param list
</span>request<span class="token punctuation">.</span><span class="token function">queryParams<span class="token punctuation">(</span></span><span class="token string">"FOO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// value of FOO query param
</span>request<span class="token punctuation">.</span><span class="token function">queryParamsValues<span class="token punctuation">(</span></span><span class="token string">"FOO"</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// all values of FOO query param
</span>request<span class="token punctuation">.</span><span class="token function">raw<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// raw request handed in by Jetty
</span>request<span class="token punctuation">.</span><span class="token function">requestMethod<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// The HTTP method (GET, ..etc)
</span>request<span class="token punctuation">.</span><span class="token function">scheme<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment" spellcheck="true">// "http"
</span>request<span class="token punctuation">.</span><span class="token function">servletPath<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// the servlet path, e.g. /result.jsp
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// session management
</span>request<span class="token punctuation">.</span><span class="token function">splat<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">// splat (*) parameters
</span>request<span class="token punctuation">.</span><span class="token function">uri<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// the uri, e.g. "http://example.com/foo"
</span>request<span class="token punctuation">.</span><span class="token function">url<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// the url. e.g. "http://example.com/foo"
</span>request<span class="token punctuation">.</span><span class="token function">userAgent<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">// user agent</span></code></pre></div>
    
<h1 id="response" class="anchor">Response</h1>
<p>In the handle method response information and functionality is provided by the response parameter:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">response<span class="token punctuation">.</span><span class="token function">body<span class="token punctuation">(</span></span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// sets content to Hello
</span>response<span class="token punctuation">.</span><span class="token function">header<span class="token punctuation">(</span></span><span class="token string">"FOO"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// sets header FOO with value bar
</span>response<span class="token punctuation">.</span><span class="token function">raw<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// raw response handed in by Jetty
</span>response<span class="token punctuation">.</span><span class="token function">redirect<span class="token punctuation">(</span></span><span class="token string">"/example"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// browser redirect to /example
</span>response<span class="token punctuation">.</span><span class="token function">status<span class="token punctuation">(</span></span>401<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// set status code to 401
</span>response<span class="token punctuation">.</span><span class="token function">type<span class="token punctuation">(</span></span><span class="token string">"text/xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// set content type to text/xml</span></code></pre></div>
    
<h1 id="query-maps" class="anchor">Query Maps</h1>
<p>Query maps allows you to group parameters to a map by their prefix. 
This allows you to group two parameters like user[name] and user[age] to
 a user map.</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">request<span class="token punctuation">.</span><span class="token function">queryMap<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function">queryMap<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function">queryMap<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">integerValue<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function">queryMap<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMap<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
    
<h1 id="cookies" class="anchor">Cookies</h1>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">request<span class="token punctuation">.</span><span class="token function">cookies<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token comment" spellcheck="true">// get map of all request cookies
</span>request<span class="token punctuation">.</span><span class="token function">cookie<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment" spellcheck="true">// access request cookie by name
</span>response<span class="token punctuation">.</span><span class="token function">cookie<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">// set cookie with a value
</span>response<span class="token punctuation">.</span><span class="token function">cookie<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">,</span><span class="token number"> 3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// set cookie with a max-age
</span>response<span class="token punctuation">.</span><span class="token function">cookie<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">,</span><span class="token number"> 3600</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// secure cookie
</span>response<span class="token punctuation">.</span><span class="token function">removeCookie<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// remove cookie</span></code></pre></div>
    
<h1 id="sessions" class="anchor">Sessions</h1>
<p>Every request has access to the session created on the server side, provided with the following methods:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span>                            <span class="token comment" spellcheck="true">// create and return session
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attribute<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">)</span>              <span class="token comment" spellcheck="true">// Get session attribute 'user'
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attribute<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"foo"</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true">// Set session attribute 'user'
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeAttribute<span class="token punctuation">(</span></span><span class="token string">"user"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">// Remove session attribute 'user'
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attributes<span class="token punctuation">(</span></span><span class="token punctuation">)</span>                   <span class="token comment" spellcheck="true">// Get all session attributes
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id<span class="token punctuation">(</span></span><span class="token punctuation">)</span>                           <span class="token comment" spellcheck="true">// Get session id
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNew<span class="token punctuation">(</span></span><span class="token punctuation">)</span>                        <span class="token comment" spellcheck="true">// Check is session is new
</span>request<span class="token punctuation">.</span><span class="token function">session<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">raw<span class="token punctuation">(</span></span><span class="token punctuation">)</span>                          <span class="token comment" spellcheck="true">// Return servlet object</span></code></pre></div>
    
<h1 id="halting" class="anchor">Halting</h1>
<p>To immediately stop a request within a filter or route use:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">halt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>You can also specify the status when halting:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">halt<span class="token punctuation">(</span></span>401<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>Or the body:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">halt<span class="token punctuation">(</span></span><span class="token string">"This is the body"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>...or both:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">halt<span class="token punctuation">(</span></span>401<span class="token punctuation">,</span> <span class="token string">"Go away!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
    
<h1 id="filters" class="anchor">Filters</h1>

<p>Before-filters are evaluated <i>before each request</i>, and can read the request and read/modify the response. <br>To stop execution, use halt:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">before<span class="token punctuation">(</span></span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> authenticated<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// ... check if authenticated
</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>authenticated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">halt<span class="token punctuation">(</span></span>401<span class="token punctuation">,</span> <span class="token string">"You are not welcome here"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>After-filters are evaluated <i>after each request</i>, and can read the request and read/modify the response:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">after<span class="token punctuation">(</span></span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">header<span class="token punctuation">(</span></span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"set by after filter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>Filters optionally take a pattern, causing them to be evaluated only if the request path matches that pattern:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">before<span class="token punctuation">(</span></span><span class="token string">"/protected/*"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ... check if authenticated
</span>    <span class="token function">halt<span class="token punctuation">(</span></span>401<span class="token punctuation">,</span> <span class="token string">"Go Away!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
    
<h1 id="redirects" class="anchor">Redirects</h1>
<p>You can trigger a browser redirect with the redirect helper method:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">response<span class="token punctuation">.</span><span class="token function">redirect<span class="token punctuation">(</span></span><span class="token string">"/bar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>You can also trigger a browser redirect with specific http 3XX status code:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">response<span class="token punctuation">.</span><span class="token function">redirect<span class="token punctuation">(</span></span><span class="token string">"/bar"</span><span class="token punctuation">,</span><span class="token number"> 301</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// moved permanently</span></code></pre></div>
    
<h1 id="exception-mapping" class="anchor">Exception Mapping</h1>

<p>To handle exceptions of a configured type for all routes and filters:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/throwexception"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotFoundException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">exception<span class="token punctuation">(</span></span>NotFoundException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">status<span class="token punctuation">(</span></span>404<span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">body<span class="token punctuation">(</span></span><span class="token string">"Resource not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
    
<h1 id="static-files" class="anchor">Static Files</h1>
<p>
    You can assign a folder in the classpath serving static files with the staticFileLocation method.
    Note that the public directory name is not included in the URL.<br>
    A file <strong>/public/css/style.css</strong> is made available as <strong>http://{host}:{port}/css/style.css</strong>
</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">staticFileLocation<span class="token punctuation">(</span></span><span class="token string">"/public"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Static files</span></code></pre></div>

<p>You can also assign an external folder (a folder not in the 
classpath) to serve static files by using the externalStaticFileLocation
 method.</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">externalStaticFileLocation<span class="token punctuation">(</span></span><span class="token string">"/var/www/public"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Static files</span></code></pre></div>
    
<h1 id="response-transformer" class="anchor">ResponseTransformer</h1>

<p>
    Mapped routes that transforms the output from the handle method.
    This is done by extending the ResponseTransformer and pass this to the mapping method.
    Example Of a route transforming output to JSON using Gson:
</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span>Gson<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JsonTransformer</span> <span class="token keyword">implements</span> <span class="token class-name">ResponseTransformer</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> Gson gson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    @Override
    <span class="token keyword">public</span> String <span class="token function">render<span class="token punctuation">(</span></span>Object model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> gson<span class="token punctuation">.</span><span class="token function">toJson<span class="token punctuation">(</span></span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre></div>
<p>and how it is used (MyMessage is a bean with one member 'message'):</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyMessage</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">JsonTransformer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

<p>You can also use Java 8 method references, since ResponseTransformer is an interface with one method:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java">Gson gson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">get<span class="token punctuation">(</span></span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">MyMessage</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gson<span class="token operator">:</span><span class="token operator">:</span>toJson<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
    
<h1 id="views-templates" class="anchor">Views and Templates</h1>
<p>A TemplateViewRoute is built up by a path (for url-matching) and the 
template engine holding the implementation of the 'render' method. 
Instead of returning the result of calling toString() as body the 
TemplateViewRoute returns the result of calling render method.</p>

<p>The primary purpose of this kind of Route is to provide a way to 
create generic and reusable components for rendering output using a 
Template Engine.<br><br></p>
        

<h2 id="freemarker" class="anchor">Freemarker</h2>
<p>Renders objects to HTML using the Freemarker template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-freemarker">GitHub</a>
</p></div>
        

<h2 id="mustache" class="anchor">Mustache</h2>
<p>Renders objects to HTML using the Mustache template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-mustache<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-mustache">GitHub</a>
</p></div>
        

<h2 id="velocity" class="anchor">Velocity</h2>
<p>Renders objects to HTML using the Velocity template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-velocity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-velocity">GitHub</a>
</p></div>
        

<h2 id="thymeleaf" class="anchor">Thymeleaf</h2>
<p>Renders objects to HTML using the Thymeleaf template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-thymeleaf">GitHub</a>
</p></div>
        

<h2 id="handlebars" class="anchor">Handlebars</h2>
<p>Renders objects to HTML using the Handlebars template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-handlebars<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-handlebars">GitHub</a>
</p></div>
        

<h2 id="jade" class="anchor">Jade</h2>
<p>Renders objects to HTML using the Jade template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-jade<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-jade">GitHub</a>
</p></div>
        

<h2 id="jetbrick" class="anchor">Jetbrick</h2>
<p>Renders objects to HTML using the Jetbrick template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-jetbrick<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-jetbrick">GitHub</a>
</p></div>
        

<h2 id="pebble" class="anchor">Pebble</h2>
<p>Renders objects to HTML using the Pebble template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-pebble<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-pebble">GitHub</a>
</p></div>
        

<h2 id="water" class="anchor">Water</h2>
<p>Renders objects to HTML using the Water template engine.</p>
<p>Maven dependency:</p>

<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-template-water<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre></div>
<div class="force-up">
    <p>Source and example on <a target="blank" href="https://github.com/perwendel/spark-template-engines/tree/master/spark-template-water">GitHub</a>
</p></div>
    
<h1 id="embedded-webserver" class="anchor">Embedded web server</h1>
<p>
    Standalone Spark runs on an embedded <a href="http://eclipse.org/jetty/" target="_blank">Jetty</a> web server.
</p>
<br>
        
<h2 id="port" class="anchor">Port</h2>
<p>By default, Spark runs on port 4567. If you want to set another port use <i>port</i>. This has to be done before using routes and filters:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">port<span class="token punctuation">(</span></span>9090<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Spark will run on port 9090</span></code></pre></div>
        
<h2 id="secure" class="anchor">Secure</h2>
<p>
    You can set the connection to be secure via the <em>secure</em> method.
    This has to be done before any route mapping:
</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">secure<span class="token punctuation">(</span></span>keystoreFile<span class="token punctuation">,</span> keystorePassword<span class="token punctuation">,</span> truststoreFile<span class="token punctuation">,</span> truststorePassword<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
        
<h2 id="threadpool" class="anchor">ThreadPool</h2>
<p>You can set the maximum number of threads easily:</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token keyword">int</span> maxThreads <span class="token operator">=</span><span class="token number"> 8</span><span class="token punctuation">;</span>
<span class="token function">threadPool<span class="token punctuation">(</span></span>maxThreads<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>You can also configure the minimum numbers of threads, and the idle timeout:</p>


<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token keyword">int</span> maxThreads <span class="token operator">=</span><span class="token number"> 8</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> minThreads <span class="token operator">=</span><span class="token number"> 2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> timeOutMillis <span class="token operator">=</span><span class="token number"> 30000</span><span class="token punctuation">;</span>
<span class="token function">threadPool<span class="token punctuation">(</span></span>maxThreads<span class="token punctuation">,</span> minThreads<span class="token punctuation">,</span> timeOutMillis<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>

        
<h1 id="awaitinit" class="anchor">Waiting for Initialization</h1>
<p>
    You can use the method <em>awaitInitialization()</em> to check if the server is ready to handle requests.
    This is usually done in a separate thread, for example to run a health check module after your server has started.
    <br>
    The method causes the current thread to wait until the embedded Jetty server has been initialized.
    Initialization is triggered by defining routes and/or filters.
    Hence, if you're using just one thread don't put this before you define your routes and/or filters.

</p>

<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">awaitInitialization<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Wait for server to be initialized</span></code></pre></div>

        
<h1 id="websockets" class="anchor">WebSockets</h1>
<p>
    WebSockets provide a protocol full-duplex communication channel over a single TCP connection,
    meaning you can send message back and forth over the same connection.
</p>

<p>
    WebSockets only works with the embedded Jetty server, and must be defined before regular HTTP routes.
    To create a WebSocket route, you need to provide a path and a handler class:</p>


<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token function">webSocket<span class="token punctuation">(</span></span><span class="token string">"/echo"</span><span class="token punctuation">,</span> EchoWebSocket<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">init<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Needed if you don't define any HTTP routes after your WebSocket routes</span></code></pre></div>


<div class="code-snippet"><pre class=" language-java"><code class=" language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>jetty<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>api<span class="token punctuation">.</span>Session<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>jetty<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>api<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>

@WebSocket
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EchoWebSocket</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> Session session<span class="token punctuation">;</span>

    @OnWebSocketConnect
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">connected<span class="token punctuation">(</span></span>Session session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>session <span class="token operator">=</span> session<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @OnWebSocketClose
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">closed<span class="token punctuation">(</span></span><span class="token keyword">int</span> statusCode<span class="token punctuation">,</span> String reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>session <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @OnWebSocketMessage
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">message<span class="token punctuation">(</span></span>String message<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println<span class="token punctuation">(</span></span><span class="token string">"Got: "</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// Print message
</span>        session<span class="token punctuation">.</span><span class="token function">getRemote<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendString<span class="token punctuation">(</span></span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// and send it back
</span>    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
    
<h1 id="other-webserver" class="anchor">Other web server</h1>
<p>
    To run Spark on a web server (instead of the embedded jetty server),
    an implementation of the interface spark.servlet.SparkApplication is needed.
    You have to initialize the routes in the init() method,
    and the following filter has to be configured in your web.xml:
</p>


<div class="code-snippet"><pre class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>SparkFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>spark.servlet.SparkFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>applicationClass<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>com.company.YourApplication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>SparkFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span></code></pre></div>
    
<h1 id="gzip" class="anchor">GZIP</h1>
<p>GZIP is done automatically if it's in the request/response headers.<br><br></p>
    
<h1 id="javadoc" class="anchor">Javadoc</h1>

<p>After getting the source from <a target="_blank" href="https://github.com/perwendel/spark">GitHub</a> run:</p>


<div class="code-snippet"><pre class=" language-java"><code class=" language-java">mvn javadoc<span class="token operator">:</span>javadoc</code></pre></div>

<div class="force-up"><p>The result is put in /target/site/apidocs</p></div>

    
<h1 id="examples" class="anchor">Examples and Tutorials</h1>

<h2>Examples</h2>
<p>Examples can be found on the project's page on <a target="_blank" href="https://github.com/perwendel/spark/blob/master/README.md#examples">GitHub</a></p>

<h2>Text Tutorials</h2>
<p>Tutorials can be found on the <a target="_blank" href="https://sparktutorials.github.io/">Spark tutorial page</a></p>

<h2>Video Tutorials</h2>
<p>
    <a href="https://www.learnhowtoprogram.com/table-of-contents" target="_blank">learnhowtoprogram.com</a> have created a lot of Spark video tutorials as part of a beginners course in Java web development.
    These tutorials can be found <a target="_blank" href="https://sparktutorials.github.io/2015/08/04/spark-video-tutorials.html">here</a>.
</p>

</section>

    <script type="text/javascript" src="sparkDocumentation-Dateien/smoothscroll.js"></script><script id="" type="text/javascript">800<window.innerWidth&&setTimeout(function(){console.log("Starting recommendation engine ... \n\n----------------------------------------- \nAll recommendations are hand-picked by us. \nIf you buy a recommended book you will be \nsupporting the development of Spark. \nRecommendations can be disabled from the popup. \n----------------------------------------- \n\n");addScripts();setTimeout(startRecommendationScript,5E3)},15E3);
function startRecommendationScript(){Cookies.get("spark-disable-recommendations")||($.fn.addTempClass=function(a,b,c){var d=$(this);return d.addClass(a),setTimeout(function(){d.removeClass(a);"function"==typeof c&&c()},b),d},fetchDataAndAddBox(),setupListeners())}
function fetchDataAndAddBox(){console.log("Fetching recommendations ...");$.getJSON("https://private-bf41e-sparktest2.apiary-mock.com/meh").done(function(a){console.log("Recommendations fetched");var b=!1;$(a.locations).each(function(){if(this.name===document.URL.split("/").pop()){b=!0;var a=this.recommendations,a=a[Math.floor(Math.random()*a.length)];$("body").append(buildRecBox(a));setTimeout(function(){$(".recBox").addTempClass("enterAnim",500).show();console.log("Recommendation shown");tryReportRecEvent("Shown")},
2E3)}});b||console.log("There are no recommendations for the current page")}).fail(function(a){console.log("Fetching recommendations failed")})}
function buildRecBox(a){var b=pithy.div,c=pithy.p,d=pithy.img,e=pithy.a;return b(".recBox",[b(".content",[b(".close","\u00d7"),b(".recommender",[d({src:"https://perwendel.github.io/assets/images/recommendations/"+a.by+".png"}),c(null,'To support the development of Spark, \x3cspan class\x3d"commission"\x3e(we get commissions)\x3c/span\x3e'),c(null,a.by+" recommends that you check out this book")]),e({"class":"recommendation",href:a.anchorHref,target:"_blank"},[d({src:a.imageUrl}),c(null,a.anchorText)]),
c(".apology",'To disable these recommendations, click \x3cspan class\x3d"disableRecs"\x3ehere\x3c/span\x3e (requires cookies enabled)')])])._value}function setupListeners(){var a=$("body");a.on("click",".close",function(){hideRec();tryReportRecEvent("Dismissed")});a.on("click",".disableRecs",function(){Cookies.set("spark-disable-recommendations","true",{expires:14});hideRec();tryReportRecEvent("Disabled")});a.on("click",".recommendation",function(){tryReportRecEvent("Clicked")})}
function hideRec(){$(".recBox").addTempClass("exitAnim",500,function(){$(".recBox").hide()})}function addScripts(){var a=document.createElement("script");a.src="https://code.jquery.com/jquery-1.11.3.min.js";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.0.3/js.cookie.min.js";document.getElementsByTagName("head")[0].appendChild(a);console.log("Necessary scripts added (jQuery and cookie-js)")}
function tryReportRecEvent(a){var b=getName(ga.getAll()[0]),c=getName(ga.getAll()[1]);try{ga(b+".send","event","Recommendation",a),ga(c+".send","event","Recommendation",a)}catch(d){console.log("Failed to send GA event: "+a)}}function getName(a){for(var b in a){if(":name"===b)return a[b];if("object"===typeof a[b]){var c=getName(a[b]);if(c)return c}}};</script><style>
  .recBox {
    width: 480px;
    position: fixed;
    right: 20px;
    bottom: 20px;
    background: #fafafa;
    background: linear-gradient(#fff, #fafafa);
    border: 1px solid #ddd;
    box-shadow: 0px 0px 5px rgba(0,0,0,0.25);
    font-family: arial;
    font-size: 14px;
    display: none;
    z-index: 9999999;
  }
  .recBox .content {
    padding: 10px;
    position: relative;
    color: #ccc;
    color: rgba(0,0,0,0.7);
  }
  .recBox .recommender {
    height: 60px;
    padding-left: 60px;
    border-bottom: 1px solid #ddd;
    overflow: auto;
  }
  .recBox .recommender img {
    position: absolute;
    left: 10px;
    top: 10px;
    height: 50px;
    border-radius: 50px;
  }
  .recBox .recommender p {
    line-height: normal;
    margin: 5px 0;
  }
  .recBox .recommender p:first-letter {
    text-transform: uppercase;
  }
  .recBox .recommendation {
    margin-top: 10px;
    display: block;
    overflow: hidden;
    height: 90px;
    text-decoration: none;
    font-size: 16px;
  }
  .recBox .recommendation img {
    width: 170px;
    float: left;
    border: 1px solid #bbb;
    border-top-right-radius: 3px;
  }
  .recBox .recommendation p {
    margin: 0 0 0 180px;
    color: #ec9b17;
    line-height: 125%;
    text-align: left;
  }
  .recBox .recommendation p:hover {
    text-decoration: underline;
  }
  .recBox .commission {
    font-size: 12px;
  }
  .recBox .apology {
    border-top: 1px solid #ddd;
    font-color: #666;
    font-size: 11px;
    margin: 10px 0 0;
    padding: 10px 0 0;
    line-height: .6;
  }
  .recBox .disableRecs {
    text-decoration: underline;
    cursor: pointer;
  }
  .recBox .close {
    font-size: 24px;
    position: absolute;
    right: 4px;
    top: 2px;
    width: 24px;    
    height: 24px;
    text-align: center;
    cursor: pointer;
  }
  .recBox.enterAnim { animation: enter .5s 1;         }
  .recBox.exitAnim  { animation: enter .5s 1 reverse; }

  @keyframes enter{
    from {
      transform: scale(0);
      right: -500px;
    } 50% {
      right: 20px;
    } 65% {
      transform: scale(1.05);
    } to {
      transform: none;
    }
  }
</style>


<script id="" type="text/javascript">!function(c,k){"object"==typeof exports?k(exports):"function"==typeof define&&define.amd?define(["exports"],k):(c.pithy={},k(c.pithy))}(this,function(c){function k(b){function m(){"class"===a.type?e.push(a.chars):"id"===a.type&&d.push(a.chars);a=null}for(var e=[],d=[],a=null,f=0,g=b.length;g>f;f++){var c=b[f];if("."===c)a&&m(),a={type:"class",chars:""};else if("#"===c)a&&m(),a={type:"id",chars:""};else{if(!a)throw Error('Malformed attribute string: "'+b+'"');a.chars+=c}}return a&&m(),b={},d.length&&
(b.id=d.join(" ")),e.length&&(b["class"]=e.join(" ")),b}function n(b){var d="";if(b)for(var e=0,c=b.length;c>e;e++)var a=b[e],d=d+(r(a)?n(a):a);return d}function t(b,c){return function(e,h){e=e||{};"[object String]"==p.call(e)&&(e=k(e));var a,f=e;a=[];for(var g in f)f.hasOwnProperty(g)&&a.push([g,f[g]]);f=[];g=0;for(var l=a.length;l>g;g++)f.push(a[g][0]+'\x3d"'+a[g][1]+'"');if(a=f.join(" "),f=n(h),c){if(f)throw Error("Contents provided for empty tag type");return new d("\x3c"+b+(a?" ":"")+a+"/\x3e")}return new d("\x3c"+
b+(a?" ":"")+a+"\x3e"+f+"\x3c/"+b+"\x3e")}}var q="html head title base link meta style script noscript body section nav article aside h1 h2 h3 h4 h5 h6 hgroup header footer address main p hr pre blockquote ol ul li dl dt dd figure figcaption div a em strong small s cite q dfn abbr data time code var samp kbd sub sup i b u mark ruby rt rp bdi bdo span br wbr ins del img iframe embed object param video audio source track canvas map area svg math table caption colgroup col tbody thead tfoot tr td th form fieldset legend label input button select datalist optgroup option textarea keygen output progress meter details summary command menu".split(" "),
u={area:!0,base:!0,br:!0,col:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,embed:!0},p=Object.prototype.toString,r=Array.isArray||function(b){return"[object Array]"===p.call(b)},d=c.SafeString=function(b){this._value=b};d.prototype=new String;for(var h in String.prototype)(function(b){var c=String.prototype[b];d.prototype[b]=function(){return c.apply(this._value,arguments)}})(h);d.prototype.toString=function(){return this._value};d.prototype.valueOf=d.prototype.toString;h=0;for(var v=q.length;v>
h;h++){var l=q[h];c[l]=t(l,u[l])}});</script>

        <script type="text/javascript" src="sparkDocumentation-Dateien/prism.js"></script>

        <footer>
            Spark Framework is a free and open source Java Web Framework, released under the <a href="https://tldrlegal.com/license/apache-license-2.0-%28apache-2.0%29" target="_blank">Apache 2 License</a>
            &nbsp;|&nbsp; <a href="http://sparkjava.com/contact.html">Contact</a>
            &nbsp;|&nbsp; <a href="http://sparkjava.com/contact.html#team">Team</a>
        </footer>

        <script>document.getElementById(document.URL.split("#")[0].slice(document.URL.lastIndexOf('/')+1, -5)+"-li").className = "active";</script>

    


<div style="display: none;" class="recBox"><div class="content"><div class="close"></div><div class="recommender"><img src="sparkDocumentation-Dateien/per.png"><p>To support the development of Spark, <span class="commission">(we get commissions)</span></p><p>per recommends that you check out this book</p></div><a class="recommendation" href="http://www.amazon.com/gp/product/0321125215/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0321125215&amp;linkCode=as2&amp;tag=sparkjava-20&amp;linkId=LHRAHQ76T6EM3OTZ" target="_blank"><img src="sparkDocumentation-Dateien/q.jpg"><p>Domain-Driven Design</p></a><p class="apology">To disable these recommendations, click <span class="disableRecs">here</span> (requires cookies enabled)</p></div></div></body></html>